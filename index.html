<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Update</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./style.css">


    <style>
        body { font-family: system-ui, sans-serif; margin: 2rem; }
        table { width: 100%; border-collapse: collapse; font-variant-numeric: tabular-nums; }
        th, td { border: 1px solid #ccc; padding: .5rem .7rem; text-align: center; }
        th:first-child, td:first-child { text-align: left; }
        thead th { background: #f0f2f5; }
        tbody tr:nth-child(even) { background: #fafafa; }
        tbody tr.ours { background: #d7f7d7; font-weight: bold; }
    </style>


  <style>
    :root { --handle-size: 24px; --track-height: 4px; }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;

    }
    h1 {
      font-size: clamp(20px, 2.5vw, 28px);
      font-weight: 600;
      margin: 20px auto;
      text-align: center;
    }

    /* contenitore verticale */
    .list {
      display: flex;
      flex-direction: column;
      gap: 28px;
      padding: 18px;
      max-width: 1000px;
      margin: 0 auto 32px;
    }

    .compare {
      position: relative;
      width: 100%;
      aspect-ratio: 16 / 9;
      overflow: hidden;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,.45);
      background: #000;
      user-select: none;
      touch-action: none;
    }
    .compare img {
      position: absolute; inset: 0;
      width: 100%; height: 100%; object-fit: cover;
      contain: layout paint;
      will-change: clip-path;
    }
    .top { clip-path: inset(0 50% 0 0); }
    .divider { position: absolute; inset: 0; pointer-events: none; }
    .divider-line {
      position: absolute; top: 0; bottom: 0;
      width: 2px; background: rgba(255,255,255,.9);
      box-shadow: 0 0 0 1px rgba(0,0,0,.35);
      left: 50%;
    }
    .handle {
      position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: var(--handle-size); height: var(--handle-size);
      border-radius: 50%; background: #fff;
      box-shadow: 0 3px 12px rgba(0,0,0,.35);
      display: grid; place-items: center;
      cursor: ew-resize; border: 1px solid rgba(0,0,0,.15);
    }
    .handle::before, .handle::after {
      content: ""; width: 6px; height: 10px;
      border-inline: 2px solid #111; border-radius: 2px;
      margin-inline: -2px;
    }
    .slider {
      position: absolute; left: 50%; bottom: 12px;
      transform: translateX(-50%);
      width: min(520px, 86%); height: var(--track-height);
      appearance: none; background: rgba(255,255,255,.35);
      border-radius: 999px; outline: none;
    }
    .slider::-webkit-slider-thumb,
    .slider::-moz-range-thumb {
      width: var(--handle-size); height: var(--handle-size);
      border-radius: 50%; background: #fff;
      border: 1px solid rgba(0,0,0,.15);
      box-shadow: 0 3px 12px rgba(0,0,0,.35);
      cursor: ew-resize;
    }

    .label {
      position: absolute; top: 10px;
      font-size: 14px; padding: 6px 10px;
      border-radius: 8px; background: rgba(0,0,0,.55);
      backdrop-filter: blur(4px); white-space: nowrap;
      color: white;
    }
    .label.left  { left: 12px; }
    .label.right { right: 12px; }

    .img-name {
      position: absolute; top: 10px; right: 12px;
      font-size: 13px; padding: 4px 8px;
      border-radius: 6px; background: rgba(255,255,255,.8);
      color: #121417; font-weight: 600; white-space: nowrap;
      pointer-events: none;
    }
    .img-name.top    { z-index: 2; }
    .img-name.bottom { z-index: 1; opacity: .85; }
  </style>


</head>
<body>


    <div class="container mt-5">


  <div class="grid" id="gallery"></div>




    <div class="list" id="gallery"></div>

  <template id="compare-template">
    <figure class="compare" aria-label="Confronto immagini con cursore">
      <img class="bottom" alt="">
      <img class="top" alt="">
      <figcaption class="label left">Ref-GS</figcaption>
      <figcaption class="label right">Light Probes</figcaption>
      <div class="img-name bottom"></div>
      <div class="img-name top"></div>
      <div class="divider" aria-hidden="true">
        <div class="divider-line"></div>
        <div class="handle"></div>
      </div>
      <input class="slider" type="range" min="0" max="100" value="50" step="0.1"
             aria-label="Posizione del cursore di confronto (percentuale)" />
    </figure>
  </template>


  <script>
    const images = [
      { src: "./ref_real/gardenspheres/lp/outputs/0.png", name: "Montagna", alt: "Montagna al tramonto" },
      { src: "./ref_real/gardenspheres/ref-gs/outputs/0.png", name: "Mare",     alt: "Mare calmo" },
      { src: "./ref_real/gardenspheres/lp/outputs/1.png", name: "Montagna", alt: "Montagna al tramonto" },
      { src: "./ref_real/gardenspheres/ref-gs/outputs/1.png", name: "Mare",     alt: "Mare calmo" },
      { src: "./ref_real/gardenspheres/lp/outputs/3.png", name: "Montagna", alt: "Montagna al tramonto" },
      { src: "./ref_real/gardenspheres/ref-gs/outputs/3.png", name: "Mare",     alt: "Mare calmo" },
      { src: "./ref_real/gardenspheres/lp/outputs/5.png", name: "Montagna", alt: "Montagna al tramonto" },
      { src: "./ref_real/gardenspheres/ref-gs/outputs/5.png", name: "Mare",     alt: "Mare calmo" },
      { src: "./ref_real/gardenspheres/lp/outputs/7.png", name: "Montagna", alt: "Montagna al tramonto" },
      { src: "./ref_real/gardenspheres/ref-gs/outputs/7.png", name: "Mare",     alt: "Mare calmo" },
      { src: "./ref_real/gardenspheres/lp/outputs/11.png", name: "Montagna", alt: "Montagna al tramonto" },
      { src: "./ref_real/gardenspheres/ref-gs/outputs/11.png", name: "Mare",     alt: "Mare calmo" },
      { src: "./ref_real/gardenspheres/lp/outputs/13.png", name: "Montagna", alt: "Montagna al tramonto" },
      { src: "./ref_real/gardenspheres/ref-gs/outputs/13.png", name: "Mare",     alt: "Mare calmo" },
      { src: "./ref_real/gardenspheres/lp/outputs/17.png", name: "Montagna", alt: "Montagna al tramonto" },
      { src: "./ref_real/gardenspheres/ref-gs/outputs/17.png", name: "Mare",     alt: "Mare calmo" },
      


    ];

    function pairwise(arr) {
      const out = [];
      for (let i = 0; i + 1 < arr.length; i += 2) out.push([arr[i], arr[i + 1]]);
      return out;
    }

    class CompareSlider {
      constructor(root) {
        this.root   = root;
        this.topImg = root.querySelector('.top');
        this.botImg = root.querySelector('.bottom');
        this.slider = root.querySelector('.slider');
        this.line   = root.querySelector('.divider-line');
        this.handle = root.querySelector('.handle');

        this.w = root.clientWidth;
        this.isDragging = false;
        this.frame = null;

        this.slider.addEventListener('input', (e) => this.schedule(parseFloat(e.target.value)), { passive: true });

        const start = (e) => { this.isDragging = true; if (e.type === 'mousedown') e.preventDefault(); };
        const move  = (e) => {
          if (!this.isDragging) return;
          const x = (e.touches?.[0]?.clientX) ?? e.clientX;
          this.schedule(this.evtToPct(x));
        };
        const end   = () => { this.isDragging = false; };

        this.handle.addEventListener('mousedown', start);
        window.addEventListener('mousemove', move, { passive: true });
        window.addEventListener('mouseup', end);
        this.handle.addEventListener('touchstart', start, { passive: true });
        window.addEventListener('touchmove', move, { passive: true });
        window.addEventListener('touchend', end);

        new ResizeObserver(() => {
          this.w = this.root.clientWidth;
          this.schedule(parseFloat(this.slider.value));
        }).observe(this.root);

        this.setPosition(parseFloat(this.slider.value));
      }

      evtToPct(clientX) {
        const rect = this.root.getBoundingClientRect();
        return ((clientX - rect.left) / rect.width) * 100;
      }
      setPosition(pct) {
        pct = Math.max(0, Math.min(100, pct));
        this.topImg.style.clipPath = `inset(0 ${100 - pct}% 0 0)`;
        const px = (pct / 100) * this.w;
        this.line.style.left = px + 'px';
        this.handle.style.left = px + 'px';
        this.slider.value = pct;
      }
      schedule(pct) {
        if (this.frame) cancelAnimationFrame(this.frame);
        this.frame = requestAnimationFrame(() => this.setPosition(pct));
      }
    }

    const list = document.getElementById('gallery');
    const tpl  = document.getElementById('compare-template');

    pairwise(images).forEach(([a, b]) => {
      const node = tpl.content.cloneNode(true);
      const root = node.querySelector('.compare');

      const bottom = root.querySelector('.bottom');
      const top    = root.querySelector('.top');
      const nameB  = root.querySelector('.img-name.bottom');
      const nameT  = root.querySelector('.img-name.top');

      bottom.src = a.src; bottom.alt = a.alt || a.name;
      top.src    = b.src; top.alt    = b.alt || b.name;

    //   nameB.textContent = a.name || a.alt || '';
    //   nameT.textContent = b.name || b.alt || '';

      list.appendChild(node);

      new CompareSlider(list.lastElementChild);
    });
  </script>
        
    
        <div class="container mt-5">
        <h1>2DGS + Light Probes</h1>
        <p>
            Results are now good. 
            Approach: deferred rendering. Each surfel is associated with a roughness and position value. I splat the surfels obtaining a position map and a roughness map.
            I use position to interpolate among a grid of probes, and roughness to interpolate 'inside' the probes. <b>Results are obtained without any mlp and on par with ReF-GS on shiny blender</b>.
            (Still a lot of room for improvement).

            <br>

            It now works way better for three reasons. 
            <ol>
                <li class="m-3">Improved voronoi representation: by using a cubemap to accellerate it (each texel corresponds to a finite set of K sites), we can use many more sites (I am using K=16 and 2048 sites per probes)</li>
                <li class="m-3">Improved roughness 'interpolation': the idea is that, the rougher the material, the more spread should be the softmax weighting the selected sites. 
                    Therefore roughness ~ temperature. <b>Temperature</b> is not a property of the voronoi probe anymore. I use roughness  [0, 1] to linearly interpolate among defined
                    temperature values. This works way better than before and better than mipmapping, while being much faster.
                </li>
                <li class="m-3">Sparse Grid with optimizable position of probes: I am using also a sparse grid where the position of each probes is optimized. Given a position, I find
                    the K-nearest probes and interpolate among them with a inverse distance weighting. It's like a voronoi partition. 
                </li>
            </ol>
        </p>


        

           <h2 class="mt-5">AVG (Shiny Blender) </h2>
            <table>
                <thead>
                <tr>
                    <th>Method</th><th>PSNR</th><th>SSIM</th><th>LPIPS</th>
                </tr>
                </thead>
                <tbody>
                <tr><td>Ref-NeRF</td><td>32.32</td><td>0.956</td><td>0.110</td></tr>
                <tr><td>NeRO</td><td>29.84</td><td>0.962</td><td>0.072</td></tr>
                <tr><td>ENVIDR</td><td>32.88</td><td>0.969</td><td>0.072</td></tr>
                <tr><td>3DGS</td><td>30.37</td><td>0.947</td><td>0.083</td></tr>
                <tr><td>GaussianShader</td><td>30.42</td><td>0.951</td><td>0.082</td></tr>
                <tr><td>3iGS</td><td>30.64</td><td>0.948</td><td>0.077</td></tr>
                <tr><td>3DGS-DR</td><td>33.94</td><td>0.971</td><td>0.059</td></tr>
                <tr><td>Ref-GS (paper)</td><td>34.80</td><td>0.973</td><td>0.056</td></tr>
                <tr><td>Ref-G (re-executed)</td><td>35.57</td><td>0.975</td><td>0.048</td></tr>
                <tr class="ours"><td>Ours</td><td>35.57</td><td>0.975</td><td>0.051</td></tr>
                </tbody>
            </table>

            <h2 class="mt-5">PSNR </h2>
            <table>
            <thead>
                <tr>
                <th>Method</th><th>Car</th><th>Ball</th><th>Helmet</th><th>Teapot</th><th>Toaster</th><th>Coffee</th><th>AVG</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Ref-NeRF</td><td>30.41</td><td>29.14</td><td>29.92</td><td>45.19</td><td>25.29</td><td>33.99</td><td>32.32</td></tr>
                <tr><td>NeRO</td><td>25.53</td><td>30.26</td><td>29.20</td><td>38.70</td><td>26.46</td><td>28.89</td><td>29.84</td></tr>
                <tr><td>ENVIDR</td><td>28.46</td><td>38.89</td><td>32.73</td><td>41.59</td><td>26.11</td><td>29.48</td><td>32.88</td></tr>
                <tr><td>3DGS</td><td>27.24</td><td>27.69</td><td>28.32</td><td>45.68</td><td>20.99</td><td>32.32</td><td>30.37</td></tr>
                <tr><td>GaussianShader [12]</td><td>27.51</td><td>29.02</td><td>28.73</td><td>43.05</td><td>22.86</td><td>31.34</td><td>30.42</td></tr>
                <tr><td>3iGS</td><td>27.52</td><td>26.82</td><td>28.08</td><td>46.05</td><td>22.71</td><td>32.64</td><td>30.64</td></tr>
                <tr><td>3DGS-DR</td><td>30.43</td><td>33.44</td><td>31.49</td><td>47.00</td><td>26.69</td><td>34.61</td><td>33.94</td></tr>
                <tr><td>Ref-GS (paper)</td><td>30.94</td><td>36.10</td><td>33.40</td><td>46.69</td><td>27.28</td><td>34.38</td><td>34.80</td></tr>
                <tr><td>Ref-GS (re-executed)</td><td>31.12</td><td>38.19</td><td>35.94</td><td>46.66</td><td>27.34</td><td>34.20</td><td>35.57</td></tr>
                <tr class="ours"><td>Ours</td><td>30.42</td><td>38.96</td><td>34.99</td><td>47.47</td><td>27.26</td><td>34.30</td><td>35.57</td></tr>
            </tbody>
            </table>

             <h2 class="mt-5">SSIM </h2>
            <table>
            <thead>
                <tr>
                <th>Method</th><th>Car</th><th>Ball</th><th>Helmet</th><th>Teapot</th><th>Toaster</th><th>Coffee</th><th>AVG</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Ref-NeRF</td><td>0.949</td><td>0.956</td><td>0.955</td><td>0.995</td><td>0.910</td><td>0.972</td><td>0.956</td></tr>
                <tr><td>NeRO</td><td>0.949</td><td>0.974</td><td>0.971</td><td>0.995</td><td>0.929</td><td>0.956</td><td>0.962</td></tr>
                <tr><td>ENVIDR</td><td>0.961</td><td>0.991</td><td>0.980</td><td>0.996</td><td>0.939</td><td>0.949</td><td>0.969</td></tr>
                <tr><td>3DGS</td><td>0.930</td><td>0.937</td><td>0.951</td><td>0.996</td><td>0.895</td><td>0.971</td><td>0.947</td></tr>
                <tr><td>GaussianShader [12]</td><td>0.930</td><td>0.954</td><td>0.955</td><td>0.995</td><td>0.900</td><td>0.969</td><td>0.951</td></tr>
                <tr><td>3iGS</td><td>0.930</td><td>0.933</td><td>0.951</td><td>0.996</td><td>0.909</td><td>0.972</td><td>0.948</td></tr>
                <tr><td>3DGS-DR</td><td>0.962</td><td>0.979</td><td>0.971</td><td>0.997</td><td>0.942</td><td>0.976</td><td>0.971</td></tr>
                <tr><td>Ref-GS (re-executed)</td><td>0.961</td><td>0.981</td><td>0.975</td><td>0.997</td><td>0.950</td><td>0.973</td><td>0.973</td></tr>
                <tr><td>Ref-GS (paper)</td><td>0.966</td><td>0.989</td><td>0.984</td><td>0.984</td><td>0.951</td><td>0.976</td><td>0.975</td></tr>
                <tr class="ours"><td>Ours</td><td>0.961</td><td>0.990</td><td>0.981</td><td>0.998</td><td>0.948</td><td>0.975</td><td>0.975</td></tr>
            </tbody>
            </table>

             <h2 class="mt-5">LPIPS </h2>
            <table>
            <thead>
                <tr>
                <th>Method</th><th>Car</th><th>Ball</th><th>Helmet</th><th>Teapot</th><th>Toaster</th><th>Coffee</th><th>AVG</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Ref-NeRF</td><td>0.051</td><td>0.307</td><td>0.087</td><td>0.013</td><td>0.118</td><td>0.082</td><td>0.110</td></tr>
                <tr><td>NeRO</td><td>0.074</td><td>0.094</td><td>0.050</td><td>0.012</td><td>0.089</td><td>0.110</td><td>0.072</td></tr>
                <tr><td>ENVIDR</td><td>0.049</td><td>0.067</td><td>0.051</td><td>0.011</td><td>0.116</td><td>0.139</td><td>0.072</td></tr>
                <tr><td>3DGS</td><td>0.047</td><td>0.161</td><td>0.079</td><td>0.007</td><td>0.126</td><td>0.078</td><td>0.083</td></tr>
                <tr><td>GaussianShader [12]</td><td>0.045</td><td>0.148</td><td>0.088</td><td>0.012</td><td>0.111</td><td>0.085</td><td>0.082</td></tr>
                <tr><td>3iGS</td><td>0.045</td><td>0.166</td><td>0.073</td><td>0.006</td><td>0.098</td><td>0.077</td><td>0.077</td></tr>
                <tr><td>3DGS-DR</td><td>0.034</td><td>0.104</td><td>0.050</td><td>0.006</td><td>0.083</td><td>0.076</td><td>0.059</td></tr>
                <tr><td>Ref-GSv(re-executed)</td><td>0.034</td><td>0.104</td><td>0.050</td><td>0.006</td><td>0.083</td><td>0.076</td><td>0.059</td></tr>
                <tr><td>Ref-GS (paper)</td><td>0.030</td><td>0.074</td><td>0.028</td><td>0.006</td><td>0.072</td><td>0.079</td><td>0.048</td></tr>
                <tr class="ours"><td>Ours</td><td>0.037</td><td>0.078</td><td>0.034</td><td>0.005</td><td>0.071</td><td>0.077</td><td>0.051</td></tr>
            </tbody>
            </table>


        <div class="text-center container mt-5">
            <h3>Ball</h3>
            <video controls class="w-100 h-auto">
                <source src="./update0309/ball/ball_collage.mp4" type="video/mp4">
            </video>

            
            <div class="row">
                <div class="'col">
                    <video controls class="w-100 h-auto">
                        <source src="./update0309/ball/ball_output_plus_gt.mp4" type="video/mp4">
                    </video>
                </div>
                <div class="'col">
                    <video controls class="w-100 h-auto">
                        <source src="./update0309/ball/ball_normals_plus_gt_normal.mp4" type="video/mp4">
                    </video>
                </div>
            </div>
        </div>


        <div class="text-center container mt-5">
            <h3>Car</h3>
            <video controls class="w-100 h-auto">
                <source src="./update0309/car/car_collage.mp4" type="video/mp4">
            </video>

            
            <div class="row">
                <div class="'col">
                    <video controls class="w-100 h-auto">
                        <source src="./update0309/car/car_output_plus_gt.mp4" type="video/mp4">
                    </video>
                </div>
                <div class="'col">
                    <video controls class="w-100 h-auto">
                        <source src="./update0309/car/car_normals_plus_gt_normal.mp4" type="video/mp4">
                    </video>
                </div>
            </div>
        </div>


        <div class="text-center container mt-5">
            <h3>Coffee</h3>
            <video controls class="w-100 h-auto">
                <source src="./update0309/coffee/coffee_collage.mp4" type="video/mp4">
            </video>

            
            <div class="row">
                <div class="'col">
                    <video controls class="w-100 h-auto">
                        <source src="./update0309/coffee/coffee_output_plus_gt.mp4" type="video/mp4">
                    </video>
                </div>
                <div class="'col">
                    <video controls class="w-100 h-auto">
                        <source src="./update0309/coffee/coffee_normals_plus_gt_normal.mp4" type="video/mp4">
                    </video>
                </div>
            </div>
        </div>


        <div class="text-center container mt-5">
            <h3>Helmet</h3>
            <video controls class="w-100 h-auto">
                <source src="./update0309/helmet/helmet_collage.mp4" type="video/mp4">
            </video>

            
            <div class="row">
                <div class="'col">
                    <video controls class="w-100 h-auto">
                        <source src="./update0309/helmet/helmet_output_plus_gt.mp4" type="video/mp4">
                    </video>
                </div>
                <div class="'col">
                    <video controls class="w-100 h-auto">
                        <source src="./update0309/helmet/helmet_normals_plus_gt_normal.mp4" type="video/mp4">
                    </video>
                </div>
            </div>
        </div>


        <div class="text-center container mt-5">
            <h3>Teapot</h3>
            <video controls class="w-100 h-auto">
                <source src="./update0309/teapot/teapot_collage.mp4" type="video/mp4">
            </video>

            
            <div class="row">
                <div class="'col">
                    <video controls class="w-100 h-auto">
                        <source src="./update0309/teapot/teapot_output_plus_gt.mp4" type="video/mp4">
                    </video>
                </div>
                <div class="'col">
                    <video controls class="w-100 h-auto">
                        <source src="./update0309/teapot/teapot_normals_plus_gt_normal.mp4" type="video/mp4">
                    </video>
                </div>
            </div>
        </div>


        <div class="text-center container mt-5">
            <h3>toaster</h3>
            <video controls class="w-100 h-auto">
                <source src="./update0309/toaster/toaster_collage.mp4" type="video/mp4">
            </video>

            
            <div class="row">
                <div class="'col">
                    <video controls class="w-100 h-auto">
                        <source src="./update0309/toaster/toaster_output_plus_gt.mp4" type="video/mp4">
                    </video>
                </div>
                <div class="'col">
                    <video controls class="w-100 h-auto">
                        <source src="./update0309/toaster/toaster_normals_plus_gt_normal.mp4" type="video/mp4">
                    </video>
                </div>
            </div>
        </div>
        

    </div>

    <div class="container">

        <h1>'Naive' Spherical-Voronoi + Beta Splatting </h1>
        <p>It matches Zip-NeRF performances with 8 sites (equals to 48 coefficient oh orer 3 SHs) on Mip-NeRF360 and outperforms it on Blender and TaT dataset.
            However, it does not handle reflection better. 
        </p>

        <table class="table table-bordered table-hover align-middle">
            <thead class="table-dark">
              <tr>
                <th rowspan="2">Scene</th>
                <th colspan="3">Voronoi + Beta Splatting</th>
                <th colspan="3">ZipNeRF</th>
              </tr>
              <tr>
                <th>PSNR</th><th>SSIM</th><th>LPIPS</th>
                <th>PSNR</th><th>SSIM</th><th>LPIPS</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>bicycle</td><td>25.64</td><td>0.791</td><td>0.197</td><td>25.89</td><td>0.775</td><td>0.226</td></tr>
              <tr><td>bonsai</td><td>34.70</td><td>0.957</td><td>0.230</td><td>34.68</td><td>0.951</td><td>0.195</td></tr>
              <tr><td>counter</td><td>30.95</td><td>0.929</td><td>0.223</td><td>29.13</td><td>0.905</td><td>0.223</td></tr>
              <tr><td>flowers</td><td>22.16</td><td>0.638</td><td>0.335</td><td>22.33</td><td>0.637</td><td>0.310</td></tr>
              <tr><td>garden</td><td>27.72</td><td>0.872</td><td>0.121</td><td>28.19</td><td>0.864</td><td>0.127</td></tr>
              <tr><td>kitchen</td><td>32.54</td><td>0.934</td><td>0.150</td><td>32.35</td><td>0.929</td><td>0.134</td></tr>
              <tr><td>room</td><td>33.02</td><td>0.936</td><td>0.258</td><td>32.99</td><td>0.928</td><td>0.237</td></tr>
              <tr><td>stump</td><td>27.18</td><td>0.802</td><td>0.213</td><td>27.41</td><td>0.792</td><td>0.233</td></tr>
              <tr><td>treehill</td><td>23.06</td><td>0.653</td><td>0.337</td><td>24.01</td><td>0.677</td><td>0.279</td></tr>
              <tr class="table-secondary">
                <td><strong>AVG</strong></td><td><strong>28.55</strong></td><td><strong>0.835</strong></td><td><strong>0.229</strong></td><td><strong>28.55</strong></td><td><strong>0.829</strong></td><td><strong>0.218</strong></td>
              </tr>
            </tbody>
          </table>


          <table class="table table-bordered table-hover align-middle">
            <thead class="table-dark">
              <tr>
                <th rowspan="2">Scene</th>
                <th colspan="3">Voronoi + Beta Splatting</th>
                <th colspan="3">ZipNeRF</th>
              </tr>
              <tr>
                <th>PSNR</th><th>SSIM</th><th>LPIPS</th>
                <th>PSNR</th><th>SSIM</th><th>LPIPS</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>chair</td><td>36.94</td><td>0.989</td><td>0.013</td><td>35.75</td><td>0.987</td><td>0.017</td></tr>
              <tr><td>drums</td><td>26.92</td><td>0.958</td><td>0.040</td><td>25.90</td><td>0.948</td><td>0.054</td></tr>
              <tr><td>ficus</td><td>36.85</td><td>0.991</td><td>0.010</td><td>34.73</td><td>0.987</td><td>0.014</td></tr>
              <tr><td>hotdog</td><td>38.34</td><td>0.988</td><td>0.021</td><td>37.98</td><td>0.987</td><td>0.023</td></tr>
              <tr><td>lego</td><td>36.81</td><td>0.985</td><td>0.016</td><td>35.81</td><td>0.983</td><td>0.019</td></tr>
              <tr><td>materials</td><td>30.74</td><td>0.965</td><td>0.039</td><td>30.98</td><td>0.967</td><td>0.040</td></tr>
              <tr><td>mic</td><td>37.56</td><td>0.994</td><td>0.006</td><td>35.90</td><td>0.992</td><td>0.008</td></tr>
              <tr><td>ship</td><td>31.87</td><td>0.912</td><td>0.119</td><td>32.30</td><td>0.937</td><td>0.114</td></tr>
              <tr class="table-secondary">
                <td><strong>AVG</strong></td><td><strong>34.50</strong></td><td><strong>0.973</strong></td><td><strong>0.033</strong></td><td><strong>33.67</strong></td><td><strong>0.974</strong></td><td><strong>0.036</strong></td>
              </tr>
            </tbody>
          </table>

          <table class="table table-bordered table-hover align-middle">
            <thead class="table-dark">
              <tr>
                <th rowspan="2">Scene</th>
                <th colspan="3">Voronoi + Beta Splatting</th>
                <th colspan="3">ZipNeRF</th>
              </tr>
              <tr>
                <th>PSNR</th><th>SSIM</th><th>LPIPS</th>
                <th>PSNR</th><th>SSIM</th><th>LPIPS</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>train</td><td>22.99</td><td>0.842</td><td>0.213</td><td>22.19</td><td>0.814</td><td>0.119</td></tr>
              <tr><td>truck</td><td>26.48</td><td>0.900</td><td>0.128</td><td>25.09</td><td>0.864</td><td>0.081</td></tr>
              <tr class="table-secondary">
                <td><strong>AVG</strong></td><td><strong>24.73</strong></td><td><strong>0.871</strong></td><td><strong>0.171</strong></td><td><strong>23.64</strong></td><td><strong>0.839</strong></td><td><strong>0.100</strong></td>
              </tr>
            </tbody>
          </table>
          
          
          

    </div>
    
    

    <div class="container mt-5">
        <hr>

        <h1>Spatially-varying Envmap</h1>

        <p> An MLP without position as input produces blurry outputs. When position is included, the model learns the map much better (PSNR ~36).
            I also tried a simple light probe approach using a 4×4×4 grid, where each voxel contains a spherical Voronoi with 512 sites. Each spherical Voronoi is linearly interpolated based on position.
            The position can be computed per-pixel (slower but artifact-free) or per-vertex (much faster, but with visible aliasing). The PSNR is around 36 for the per-pixel method and around 35 for the per-vertex method.
            A single large Voronoi can't reproduce the map accurately (PSNR ~22).
        </p>

            <div class="text-center container">
                <video controls class="w-100 h-auto">
                    <source src="./classroom/lightprobes.mp4" type="video/mp4">
                </video>
            </div>


            <div class="text-center container">
                <video controls class="w-100 h-auto">
                    <source src="./classroom/sv_envmap.mp4" type="video/mp4">
                </video>
            </div>

        <!-- <ul class="list-group list-group-flush mb-5">
            <li class="list-group-item">✔️ Implemented on 2DGS and Beta-Splatting</li>
            <li class="list-group-item">✔️ SHs vs Beta Representations</li>
            <li class="list-group-item">✔️ Results on MCMC-3DGS with SGs and SVs</li>
            <li class="list-group-item">✔️ Mesh Example (needs improvement)</li>
        </ul> -->
        <h1>Envmap learning</h1>
        <p>SGS and voronoi uses 1024 gaussians/sites. Cubemap is 6x512x512, Sph-Mip is 512x1024x1 (as in ref-gs, but without mipmaps). Results are similar for every model.
            Voronoi and SGS are much more compact.
        </p>
            <div class="text-center container">
                <video controls class="w-100 h-auto">
                    <source src="./sphere_rough/envmaps_comparison.mp4" type="video/mp4">
                </video>
            </div>

        <h1 class="mt-5">Temperature is related to roughness</h1>
        <p>Instead of using mip-maps as in Ref-gs, the temperature in voronoi may be used. In this example 512 sites are used.</p>
            <div class="text-center container">
                <video controls class="w-100 h-auto">
                    <source src="./sphere_rough/voronoi_betas.mp4" type="video/mp4">
                </video>
            </div>
        <hr>

        <h1 class="mt-5">
            Reflective Direction
        </h1>

        <h3>Naive (Spherical Voronoi, but same results with SGs and SHs)</h3>

        <div class="text-center container m-5">
            <video controls class="w-25 h-auto">
                <source src="./sphere/voronoi64.mp4" type="video/mp4">
            </video>
        </div>


        <h3 class="mt-5">Using a shallow mlp to predict color-model attributes (gives spatial regularization)</h3>

        <h3 class="mt-3 text-center"></h3>
        <div class="text-center container">
            <video controls class="w-100 h-auto">
                <source src="./sphere/final.mp4" type="video/mp4">
            </video>
        </div>

        <h3> Qualitative Results </h3>



            <table class="table table-bordered table-hover align-middle">
                <thead class="table-dark">
                    <tr>
                        <th rowspan="2">Method</th>
                        <th colspan="2">Metrics</th>
                    </tr>
                    <tr>
                        <th>PSNR</th>
                        <th>SSIM</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>MLP</td><td>29.53</td><td>0.964</td></tr>
                    <tr><td>SGS</td><td>25.62</td><td>0.952</td></tr>
                    <tr><td>SV</td><td>26.77</td><td>0.950</td></tr>
                    <tr><td>SH</td><td>20.00</td><td>0.910</td></tr>

                </tbody>
            </table>






    </div>



      

    <hr>


<!-- 

    
    <h1>1. Qualitative Results</h1>
    <h3 class="mt-3 text-center">MCMC-3DGS</h3>
    <div class="text-center container">
        <video controls class="w-100 h-auto">
            <source src="./mcmc-3dgs/test_mcmc2.mp4" type="video/mp4">
        </video>
    </div>
    <div class="text-center container">
        <div class="row">
            <div class="col-6">
            <video controls class="w-100 h-auto">
                <source src="./mcmc-3dgs/zoom0_mcmc2.mp4" type="video/mp4">
            </video>
            </div>
            <div class="col-6">
            <video controls class="w-100 h-auto">
                <source src="./mcmc-3dgs/zoom1_mcmc2.mp4" type="video/mp4">
            </video>
            </div>
        </div>
    </div>

    <hr>

    <h3 class="mt-3 text-center">2DGS</h3>
    <div class="text-center container">
        <video controls class="w-100 h-auto">
            <source src="./2dgs/test_2dgs2.mp4" type="video/mp4">
        </video>
    </div>
    <div class="text-center container">
        <div class="row">
            <div class="col-6">
            <video controls class="w-100 h-auto">
                <source src="./2dgs/zoom0_2dgs2.mp4" type="video/mp4">
            </video>
            </div>
            <div class="col-6">
            <video controls class="w-100 h-auto">
                <source src="./2dgs/zoom1_2dgs2.mp4" type="video/mp4">
            </video>
            </div>
        </div>
    </div>

    <hr>

        <h3 class="mt-3 text-center">BETA-SPLATTING</h3>
    <div class="text-center container">
        <video controls class="w-100 h-auto">
            <source src="./beta_splatting/test_beta2.mp4" type="video/mp4">
        </video>
    </div>
    <div class="text-center container">
        <div class="row">
            <div class="col-6">
            <video controls class="w-100 h-auto">
                <source src="./beta_splatting/zoom0_beta2.mp4" type="video/mp4">
            </video>
            </div>
            <div class="col-6">
            <video controls class="w-100 h-auto">
                <source src="./beta_splatting/zoom1_beta2.mp4" type="video/mp4">
            </video>
            </div>
        </div>
    </div>

    <hr>

    <h1>2. Quantitative results</h1>

    <h3>a) SHs vs Spherical Betas</h3>
    <p>Results differs from paper. Spherical betas are not that better than shs, but they require half of the parameters.</p>
    <div class="container mt-4">
        <table class="table table-bordered table-hover align-middle">
            <thead class="table-dark">
            <tr>
                <th>Scene</th>
                <th colspan="3">Beta Splatting with SHs</th>
                <th colspan="3">Beta Splatting with SBs</th>
                <th colspan="3">Beta Splatting (Paper)</th>
            </tr>
            <tr>
                <th></th>
                <th>PSNR ↑</th><th>SSIM ↑</th><th>LPIPS ↓</th>
                <th>PSNR ↑</th><th>SSIM ↑</th><th>LPIPS ↓</th>
                <th>PSNR ↑</th><th>SSIM ↑</th><th>LPIPS ↓</th>
            </tr>
            </thead>
            <tbody>
            <tr><td>chair</td><td>36.87</td><td>0.990</td><td>0.013</td><td>36.95</td><td>0.990</td><td>0.013</td><td>36.70</td><td>0.990</td><td>0.010</td></tr>
            <tr><td>drums</td><td>26.30</td><td>0.956</td><td>0.043</td><td>26.77</td><td>0.958</td><td>0.039</td><td>26.81</td><td>0.958</td><td>0.032</td></tr>
            <tr><td>ficus</td><td>36.26</td><td>0.990</td><td>0.011</td><td>36.52</td><td>0.990</td><td>0.011</td><td>36.79</td><td>0.990</td><td>0.010</td></tr>
            <tr><td>hotdog</td><td>38.24</td><td>0.988</td><td>0.021</td><td>38.34</td><td>0.988</td><td>0.022</td><td>38.95</td><td>0.988</td><td>0.016</td></tr>
            <tr><td>lego</td><td>36.86</td><td>0.986</td><td>0.016</td><td>36.93</td><td>0.986</td><td>0.016</td><td>37.11</td><td>0.985</td><td>0.014</td></tr>
            <tr><td>materials</td><td>30.60</td><td>0.965</td><td>0.038</td><td>30.95</td><td>0.968</td><td>0.037</td><td>31.13</td><td>0.966</td><td>0.031</td></tr>
            <tr><td>mic</td><td>36.95</td><td>0.994</td><td>0.007</td><td>36.93</td><td>0.994</td><td>0.006</td><td>37.67</td><td>0.994</td><td>0.005</td></tr>
            <tr><td>ship</td><td>31.60</td><td>0.912</td><td>0.120</td><td>31.28</td><td>0.910</td><td>0.123</td><td>32.15</td><td>0.910</td><td>0.104</td></tr>
            <tr><td>AVG</td><td>34.21</td><td>0.973</td><td>0.034</td><td>34.33</td><td>0.973</td><td>0.033</td><td>34.66</td><td>0.973</td><td>0.028</td></tr>
            </tbody>
        </table>
    </div>

    <h3>b) MCMC with SHs, SGs and SVs</h3>

    <div class="container mt-4">
    <table class="table table-bordered table-hover align-middle">
        <thead class="table-dark">
        <tr>
            <th>Scene</th>
            <th colspan="2">SHs</th>
            <th colspan="2">SGs</th>
            <th colspan="2">SVs</th>
        </tr>
        <tr>
            <th></th>
            <th>PSNR ↑</th><th>SSIM ↑</th>
            <th>PSNR ↑</th><th>SSIM ↑</th>
            <th>PSNR ↑</th><th>SSIM ↑</th>
        </tr>
        </thead>
        <tbody>
        <tr><td>chair</td><td>36.32</td><td>0.989</td><td>36.18</td><td>0.988</td><td>36.76</td><td>0.989</td></tr>
        <tr><td>drums</td><td>26.22</td><td>0.954</td><td>26.24</td><td>0.956</td><td>27.06</td><td>0.959</td></tr>
        <tr><td>ficus</td><td>34.88</td><td>0.988</td><td>35.44</td><td>0.989</td><td>35.83</td><td>0.989</td></tr>
        <tr><td>hotdog</td><td>37.34</td><td>0.986</td><td>37.54</td><td>0.987</td><td>38.72</td><td>0.988</td></tr>
        <tr><td>lego</td><td>35.75</td><td>0.984</td><td>35.91</td><td>0.985</td><td>36.31</td><td>0.985</td></tr>
        <tr><td>materials</td><td>30.56</td><td>0.964</td><td>30.43</td><td>0.965</td><td>30.86</td><td>0.966</td></tr>
        <tr><td>mic</td><td>37.27</td><td>0.994</td><td>36.89</td><td>0.994</td><td>37.67</td><td>0.995</td></tr>
        <tr><td>ship</td><td>30.76</td><td>0.907</td><td>30.81</td><td>0.910</td><td>30.93</td><td>0.911</td></tr>
        <tr class="table-secondary"><td><strong>AVG</strong></td><td><strong>33.64</strong></td><td><strong>0.971</strong></td><td><strong>33.68</strong></td><td><strong>0.972</strong></td><td><strong>34.27</strong></td><td><strong>0.973</strong></td></tr>
        </tbody>
    </table>
    </div>

    <h3>c) Results on Materials</h3>
    <div class="container mt-5">
    <table class="table table-bordered table-hover align-middle">
        <thead class="table-dark">
        <tr>
            <th rowspan="2">Method</th>
            <th rowspan="2">Split</th>
            <th colspan="3">SHs</th>
            <th colspan="3">SGs</th>
            <th colspan="3">SVs</th>
            <th colspan="3">SBs</th>
        </tr>
        <tr>
            <th>PSNR</th><th>SSIM</th><th>LPIPS</th>
            <th>PSNR</th><th>SSIM</th><th>LPIPS</th>
            <th>PSNR</th><th>SSIM</th><th>LPIPS</th>
            <th>PSNR</th><th>SSIM</th><th>LPIPS</th>
        </tr>
        </thead>
        <tbody>
        <tr><td rowspan="2">MCMC-3DGS</td><td>test</td>
            <td>30.58</td><td>0.965</td><td>0.040</td>
            <td>30.44</td><td>0.965</td><td>0.040</td>
            <td>30.85</td><td>0.966</td><td>0.039</td>
            <td>-</td><td>-</td><td>-</td>
        </tr>
        <tr><td>train</td>
            <td>35.62</td><td>0.990</td><td>0.024</td>
            <td>35.30</td><td>0.989</td><td>0.025</td>
            <td>38.27</td><td>0.993</td><td>0.022</td>
            <td>-</td><td>-</td><td>-</td>
        </tr>

        <tr><td rowspan="2">2DGS</td><td>test</td>
            <td>29.70</td><td>0.958</td><td>0.048</td>
            <td>28.60</td><td>0.950</td><td>0.057</td>
            <td>29.83</td><td>0.959</td><td>0.0491</td>
            <td>-</td><td>-</td><td>-</td>
        </tr>
        <tr><td>train</td>
            <td>-</td><td>-</td><td>-</td>
            <td>32.41</td><td>0.978</td><td>0.039</td>
            <td>35.70</td><td>0.987</td><td>0.029</td>
            <td>-</td><td>-</td><td>-</td>
        </tr>

        <tr><td rowspan="2">Beta-Splatting</td><td>test</td>
            <td>30.62</td><td>0.965</td><td>0.038</td>
            <td>30.37</td><td>0.965</td><td>0.039</td>
            <td>30.95</td><td>0.967</td><td>0.036</td>
            <td>30.87</td><td>0.967</td><td>0.036</td>
        </tr>
        <tr><td>train</td>
            <td>37.05</td><td>0.992</td><td>0.020</td>
            <td>36.12</td><td>0.990</td><td>0.022</td>
            <td>40.92</td><td>0.995</td><td>0.018</td>
            <td>39.45</td><td>0.994</td><td>0.019</td>
        </tr>
        </tbody>
    </table>
    </div>


    <hr>


    <h1>3. Color Optimization only</h1>
    <p>Something is definitely wrong... trying to figure out what</p>
    <div class="text-center container">
        <video controls class="w-100 h-auto">
            <source src="./mesh/test_mesh.mp4" type="video/mp4">
        </video>
    </div>
    <div class="text-center container">
        <div class="row">
            <div class="col-6">
            <video controls class="w-100 h-auto">
                <source src="./mesh/zoom0_mesh.mp4" type="video/mp4">
            </video>
            </div>
            <div class="col-6">
            <video controls class="w-100 h-auto">
                <source src="./mesh/zoom1_mesh.mp4" type="video/mp4">
            </video>
            </div>
        </div>
    </div>
 -->



    <!-- <h3 class="mt-3 text-center">
        End-to-end training (30k iterations, vanilla 3DGS)
    </h3>
    

    <div class="text-center container">
        <video controls class="w-100 h-auto">
            <source src="./output_gt_twice_compressed.mp4" type="video/mp4">
        </video>
    </div>

    <h3 class="mt-3 text-center">
        Zoom
    </h3>
    
    <div class="text-center container">
        <div class="row">
            <div class="col-6">
            <video controls class="w-100 h-auto">
                <source src="./zoom0_compressed.mp4" type="video/mp4">
            </video>
            </div>
            <div class="col-6">
            <video controls class="w-100 h-auto">
                <source src="./zoom1_compressed.mp4" type="video/mp4">
            </video>
            </div>
        </div>
    </div>





 <div class="container mt-4">
    <table class="table table-bordered table-hover align-middle">
        <thead class="table-dark">
            <tr>
                <th>Model</th>
                <th>Split</th>
                <th>PSNR ↑</th>
                <th>SSIM ↑</th>
                <th>LPIPS ↓</th>
                <th>#W ↓</th>
            </tr>
        </thead>
        <tbody>
            <tr class="model-name"><td rowspan="2">Diffuse-Only</td><td>test</td><td>27.95</td><td>0.949</td><td>0.058</td><td>276675</td></tr>
            <tr><td>train</td><td>30.67</td><td>0.975</td><td>0.039</td><td>276675</td></tr>

            <tr class="model-name"><td rowspan="2">Spherical-Harmonics</td><td>test</td><td>30.00</td><td>0.961</td><td>0.043</td><td>284371</td></tr>
            <tr><td>train</td><td>35.07</td><td>0.989</td><td>0.024</td><td>284371</td></tr>

            <tr class="model-name"><td rowspan="2">Spherical-Gaussians</td><td>test</td><td>30.42</td><td>0.964</td><td>0.040</td><td>234023</td></tr>
            <tr><td>train</td><td>39.05</td><td>0.993</td><td>0.020</td><td>234023</td></tr>

            <tr class="model-name"><td rowspan="2">Spherical-Voronoi</td><td>test</td><td>30.46</td><td>0.964</td><td>0.038</td><td>278155</td></tr>
            <tr><td>train</td><td>39.66</td><td>0.993</td><td>0.019</td><td>278155</td></tr>
        </tbody>
    </table>
</div>




    <hr class="mt-5">



    <div class="container">

    <h3 class="mt-3 text-center">
        Two-Phase training 
    </h3>

    <p>(30k iterations on <em>diffuse and noisy materials scene</em> + 20k fine-tuning iterations on the full-color scene, optimizing only the color parameters)
    </p>
    
    <div class="text-center">
        <video width="640" height="360" controls>
            <source src="./materials_diffuse_compressed.mp4" type="video/mp4">
            <figcaption>Diffuse and Noisy Materials</figcaption>
        </video>
    </div>


    <div class="text-center container">
        <video controls class="w-100 h-auto">
            <source src="./pt_full_compressed.mp4" type="video/mp4">
        </video>
    </div>

    <div class="text-center container">
        <div class="row">
            <div class="col-6">
            <video controls class="w-100 h-auto">
                <source src="./zoom0_pt_compressed.mp4" type="video/mp4">
            </video>
            </div>
            <div class="col-6">
            <video controls class="w-100 h-auto">
                <source src="./zoom1_pt_compressed.mp4" type="video/mp4">
            </video>
            </div>
        </div>
    </div>



    <div class="container mt-5">
        <table class="table table-bordered table-hover align-middle">
            <thead class="table-dark">
                <tr>
                    <th>Model</th>
                    <th>Split</th>
                    <th>PSNR ↑</th>
                    <th>SSIM ↑</th>
                    <th>LPIPS ↓</th>
                    <th>#W ↓</th>
                </tr>
            </thead>
            <tbody>
                <tr class="model-name"><td rowspan="2">Spherical-Harmoics</td><td>test</td><td>27.15</td><td>0.936</td><td>0.067</td><td>143379</td></tr>
                <tr><td>train</td><td>28.62</td><td>0.959</td><td>0.058</td><td>143379</td></tr>

                <tr class="model-name"><td rowspan="2">Spherical-Gaussians</td><td>test</td><td>27.48</td><td>0.935</td><td>0.071</td><td>143379</td></tr>
                <tr><td>train</td><td>31.39</td><td>0.968</td><td>0.055</td><td>143379</td></tr>

                <tr class="model-name"><td rowspan="2">Spherical-Voronoi</td><td>test</td><td>27.12</td><td>0.932</td><td>0.075</td><td>143379</td></tr>
                <tr><td>train</td><td>32.42</td><td>0.973</td><td>0.050</td><td>143379</td></tr>
            </tbody>
        </table>
    </div>


<hr class="mt-5">

<div class="container">
    <h3 class="text-center">Results on Synthetic NeRF with Voronoi (7 sites ~ 3 SHS)</h3>
    <p>Just partial results (I am doing a sweep but takes time), could be better ... SGS are next</p>

    <table class="table table-bordered text-center align-middle">
<style>
  .table td, .table th {
    border: 1px solid #dee2e6;
  }

  .separator {
    border-left: 3px solid #000; /* separatore visivo più spesso */
  }

  .avg-row {
    background-color: #f0f0f0;
    font-weight: bold;
  }
</style>

    <table class="table table-bordered text-center align-middle">
    <thead class="table-dark">
        <tr>
        <th rowspan="2">Scene</th>
        <th colspan="3">Spherical-Voronoi</th>
        <th colspan="3" class="separator">Spherical-Harmonics</th>
        </tr>
        <tr>
        <th>PSNR</th>
        <th>SSIM</th>
        <th>LPIPS</th>
        <th class="separator">PSNR</th>
        <th>SSIM</th>
        <th>LPIPS</th>
        </tr>
    </thead>
    <tbody>
        <tr><td>chair</td><td>36.14</td><td>0.987</td><td>0.015</td><td class="separator">35.84</td><td>0.987</td><td>0.015</td></tr>
        <tr><td>drums</td><td>26.87</td><td>0.957</td><td>0.041</td><td class="separator">26.15</td><td>0.953</td><td>0.044</td></tr>
        <tr><td>ficus</td><td>35.89</td><td>0.989</td><td>0.011</td><td class="separator">34.79</td><td>0.987</td><td>0.013</td></tr>
        <tr><td>hotdog</td><td>38.05</td><td>0.986</td><td>0.026</td><td class="separator">37.64</td><td>0.985</td><td>0.026</td></tr>
        <tr><td>lego</td><td>36.33</td><td>0.984</td><td>0.019</td><td class="separator">35.70</td><td>0.982</td><td>0.019</td></tr>
        <tr><td>materials</td><td>30.46</td><td>0.964</td><td>0.038</td><td class="separator">30.01</td><td>0.959</td><td>0.043</td></tr>
        <tr><td>mic</td><td>36.35</td><td>0.993</td><td>0.007</td><td class="separator">35.49</td><td>0.991</td><td>0.008</td></tr>
        <tr><td>ship</td><td>30.96</td><td>0.909</td><td>0.124</td><td class="separator">30.85</td><td>0.904</td><td>0.130</td></tr>
        <tr class="avg-row">
        <td>AVG</td>
        <td>33.88</td><td>0.971</td><td>0.035</td>
        <td class="separator">33.31</td><td>0.969</td><td>0.037</td>
        </tr>
    </tbody>
    </table>    

</div> -->




<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="./script.js"></script>


    <script>
        // Configurazione scene
        const scenes = ['ball', 'car', 'coffee', 'helmet', 'teapot', 'toaster'];
        const basePath = './update0309';
        
        // Template per una singola scena
        function createSceneHTML(sceneName) {
            return `
                <div class="text-center scene-section" id="scene-${sceneName}">
                    <h3 class="scene-title">${sceneName}</h3>
                    
                    <!-- Video principale (collage) -->
                    <div class="main-video">
                        <video controls class="w-100 h-auto" preload="metadata">
                            <source src="${basePath}/${sceneName}/${sceneName}_collage.mp4" type="video/mp4">
                            Il tuo browser non supporta il tag video.
                        </video>
                    </div>
                    
                    <!-- Video secondari -->
                    <div class="row secondary-videos">
                        <div class="col-md-6">
                            <video controls class="w-100 h-auto" preload="metadata">
                                <source src="${basePath}/${sceneName}/${sceneName}_output_plus_gt.mp4" type="video/mp4">
                                Il tuo browser non supporta il tag video.
                            </video>
                        </div>
                        <div class="col-md-6">
                            <video controls class="w-100 h-auto" preload="metadata">
                                <source src="${basePath}/${sceneName}/${sceneName}_normals_plus_gt_normal.mp4" type="video/mp4">
                                Il tuo browser non supporta il tag video.
                            </source>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Funzione per verificare se un video esiste
        async function videoExists(url) {
            try {
                const response = await fetch(url, { method: 'HEAD' });
                return response.ok;
            } catch (error) {
                return false;
            }
        }
        
        // Funzione per caricare una scena con verifica file
        async function loadScene(sceneName) {
            const collageUrl = `${basePath}/${sceneName}/${sceneName}_collage.mp4`;
            const outputUrl = `${basePath}/${sceneName}/${sceneName}_output_plus_gt.mp4`;
            const normalsUrl = `${basePath}/${sceneName}/${sceneName}_normals_plus_gt_normal.mp4`;
            
            // Verifica se almeno il video principale esiste
            const collageExists = await videoExists(collageUrl);
            
            if (collageExists) {
                return createSceneHTML(sceneName);
            } else {
                console.warn(`Video collage non trovato per la scena: ${sceneName}`);
                return null;
            }
        }
        
        // Funzione principale per caricare tutte le scene
        async function loadAllScenes() {
            const container = document.getElementById('scene-container');
            const loading = document.getElementById('loading');
            
            // Mostra loading
            loading.style.display = 'block';
            
            try {
                // Carica tutte le scene in parallelo
                const scenePromises = scenes.map(scene => loadScene(scene));
                const sceneHTMLs = await Promise.all(scenePromises);
                
                // Filtra le scene che sono state caricate con successo
                const validScenes = sceneHTMLs.filter(html => html !== null);
                
                if (validScenes.length > 0) {
                    container.innerHTML = validScenes.join('');
                    
                    // Aggiungi gestori per errori video
                    addVideoErrorHandlers();
                } else {
                    container.innerHTML = '<div class="alert alert-warning text-center">Nessuna scena trovata.</div>';
                }
                
            } catch (error) {
                console.error('Errore nel caricamento delle scene:', error);
                container.innerHTML = '<div class="alert alert-danger text-center">Errore nel caricamento delle scene.</div>';
            } finally {
                // Nascondi loading
                loading.style.display = 'none';
            }
        }
        
        // Aggiungi gestori per errori video
        function addVideoErrorHandlers() {
            const videos = document.querySelectorAll('video');
            
            videos.forEach(video => {
                video.addEventListener('error', function(e) {
                    console.warn('Errore nel caricamento video:', this.src);
                    this.style.display = 'none';
                    
                    // Mostra messaggio di errore
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'alert alert-warning';
                    errorDiv.textContent = 'Video non disponibile';
                    this.parentNode.insertBefore(errorDiv, this.nextSibling);
                });
                
                video.addEventListener('loadedmetadata', function() {
                    console.log('Video caricato:', this.src);
                });
            });
        }
        
        // Funzioni di utilità aggiuntive
        
        // Aggiungi una nuova scena dinamicamente
        function addScene(sceneName) {
            if (!scenes.includes(sceneName)) {
                scenes.push(sceneName);
                loadScene(sceneName).then(html => {
                    if (html) {
                        const container = document.getElementById('scene-container');
                        container.insertAdjacentHTML('beforeend', html);
                        addVideoErrorHandlers();
                    }
                });
            }
        }
        
        // Rimuovi una scena
        function removeScene(sceneName) {
            const sceneElement = document.getElementById(`scene-${sceneName}`);
            if (sceneElement) {
                sceneElement.remove();
            }
            
            const index = scenes.indexOf(sceneName);
            if (index > -1) {
                scenes.splice(index, 1);
            }
        }
        
        // Aggiorna configurazione basePath
        function updateBasePath(newPath) {
            basePath = newPath;
            loadAllScenes(); // Ricarica con il nuovo path
        }
        
        // Inizializza quando il DOM è pronto
        document.addEventListener('DOMContentLoaded', function() {
            loadAllScenes();
        });
        
        // Esporta funzioni globali per uso esterno
        window.SceneGallery = {
            addScene: addScene,
            removeScene: removeScene,
            updateBasePath: updateBasePath,
            reload: loadAllScenes,
            getScenes: () => scenes
        };
    </script>
</body>
</html>
